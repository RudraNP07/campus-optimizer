<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Faculty Appointment | Campus Resource Optimizer</title>
  <link rel="stylesheet" href="../frontend/faculty.css">
</head>
<body>

  <!-- PAGE HEADER -->
  <header class="page-header">
    <h1>Faculty Appointment Booking</h1>
    <p>Select a faculty member and book an available slot</p>
  </header>

  <!-- NOTICE -->
  <section class="notice-card">
    <h3>Important Notice</h3>
    <p>
      Faculty appointments are available between
      <strong>10:00 AM – 5:00 PM</strong>.<br>
      <strong> Sunday </strong> closed.
    </p>
  </section>

  <!-- FACULTY CARDS -->
  <section class="faculty-grid">

    <div class="faculty-card">
      <h2>Dr. A. Sharma</h2>
      <p class="dept">Department: Computer Science</p>
      <p>Available: 10:00 AM – 11:00 AM</p>
      <p>Cabin: NB-203</p>
      <button class="book-btn">Book Appointment</button>
    </div>

    <div class="faculty-card">
      <h2>Prof. R. Verma</h2>
      <p class="dept">Department: Mathematics</p>
      <p>Available: 12:00 PM – 1:00 PM</p>
      <p>Cabin: NB-112</p>
      <button class="book-btn">Book Appointment</button>
    </div>


    <div class="faculty-card">
      <h2>Dr. S. Mehta</h2>
      <p class="dept">Department:Lab consultant </p>
      <p>Available: 1:00 PM – 3:00 PM</p>
      <p>Cabin: ME-305</p>
      <button class="book-btn">Book Appointment</button>
    </div>

    <div class="faculty-card">
      <h2>Dr. Dk. Mehta</h2>
      <p class="dept">Department: general</p>
      <p>Available: 3:00 PM – 4:00 PM</p>
      <p>Cabin: A-305</p>
      <button class="book-btn">Book Appointment</button>
    </div>

  </section>

  <script>
document.querySelectorAll('.book-btn').forEach(button => {
  button.addEventListener('click', async (e) => {
    // Get data from the card where the button was clicked
    const card = e.target.closest('div');
    const resourceName = card.querySelector('h2').innerText;
    const slotTime = card.querySelector('p:nth-of-type(2)').innerText;
    
    // Determine type based on page title or section
    const resourceType = document.title.split('|')[0].trim();

    try {
      const response = await fetch('/api/book', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({
          resourceType: resourceType,
          resourceName: resourceName,
          slotTime: slotTime
        })
      });

      const result = await response.json();
      if (result.success) {
        alert(result.message);
        e.target.innerText = "Booked";
        e.target.disabled = true;
        e.target.style.backgroundColor = "#ccc";
      } else {
        alert("Error: " + result.message);
      }
    } catch (err) {
      alert("Failed to connect to server.");
    }
  });
});
</script>

</body>
</html>