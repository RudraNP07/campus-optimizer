<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>library slots | Campus Resource Optimizer</title>
  <link rel="stylesheet" href="../frontend/library.css">
</head>
<body>

  <!-- PAGE HEADER -->
  <header class="page-header">
    <h1>Library slots & Books</h1>
    <p>Select a slot and book in available slot</p>
  </header>

  <!-- CLASS CARDS -->
   <h1>Available Books</h1>
    <h3>Timing:10:00am - 2:00pm</h3>
  <section class="books">
    <div class="Book-card">
      <h2>Programming Books</h2>
      <p>c,c++,java,python</p>
      <p>Status : Available</p>
      <!-- <button class="book-status">Status: Available</button> -->
    </div>

    <div class="Book-card">
      <h2>Engineering mathematics</h2>
      <p> 1st , 2nd &4th semester</p>
      <p>Status : Available</p>
      <!-- <button class="book-status">Status: Available</button> -->
    </div>

    <div class="Book-card">
      <h2>Engineering Pysics</h2>
      <p>1st,3rd,4th,6th semester</p>
      <p>Status : Available</p>
      <!-- <button class="book-status">Status: Available</button> -->
    </div>
     <div class="Book-card">
      <h2>Chemistry</h2>
      <p>4th,6th,7th semester</p>
      <p>Status : Available</p>
      <!-- <button class="book-status">Status: Available</button> -->
    </div>
    <div class="Book-card">
      <h2>Optional</h2>
      <p>IKS , EVS for 1st year</p>
      <p>Status : Available</p>
      <!-- <button class="book-status">Status: Available</button> -->
    </div>


    <div class="Book-card">
      <h2>Others</h2>
      <p>Rich dad poor dad , Atomic habits</p>
      <p>Status : Available</p>
      <!-- <button class="book-status">Status: Available</button> -->
    </div>

  </section>
  <header class="page-header">
    <h1>Library slots</h1>
    <p>Select a timing  and book an available slot</p>
  </header>

  <section class="offline">
    <div class="Book-card">
      <h2>Library - 1</h2>
      <p>open:10:00am - 1:00pm</p>
      <p>open: 1:30pm – 3:30pm</p>
      <button class="book-btn">Book slot</button>
    </div>

    <div class="Book-card">
      <h2>Library - 2</h2>
      <p>open:9:30:am - 11:30am</p>
      <p>open: 12:00pm – 4:00pm</p>
      <button class="book-btn">Book slot</button>
    </div>

    <script>
document.querySelectorAll('.book-btn').forEach(button => {
  button.addEventListener('click', async (e) => {
    // Get data from the card where the button was clicked
    const card = e.target.closest('div');
    const resourceName = card.querySelector('h2').innerText;
    const slotTime = card.querySelector('p:nth-of-type(2)').innerText;
    
    // Determine type based on page title or section
    const resourceType = document.title.split('|')[0].trim();

    try {
      const response = await fetch('/api/book', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({
          resourceType: resourceType,
          resourceName: resourceName,
          slotTime: slotTime
        })
      });

      const result = await response.json();
      if (result.success) {
        alert(result.message);
        e.target.innerText = "Booked";
        e.target.disabled = true;
        e.target.style.backgroundColor = "#ccc";
      } else {
        alert("Error: " + result.message);
      }
    } catch (err) {
      alert("Failed to connect to server.");
    }
  });
});
</script>


</body>
<section class="notice-card">
  <h3>Important Notice</h3>
  <p>
    Library  timings are in between <strong>9:30 AM to 5:30 PM</strong>.<br>
    <strong>Saturday and Sunday</strong> are holidays.
  </p>
</section>

</html>